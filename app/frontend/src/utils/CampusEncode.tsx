import booleanPointInPolygon from "@turf/boolean-point-in-polygon"
import { point, polygon } from "@turf/helpers"

export type BuildingBound = [number, number]

export type CampusBuilding = {
    name: string,
    bounds: BuildingBound[][]
}

export const BUILDINGS: CampusBuilding[] = [
    {
        name: "Residence (Juniper, Koa, Larch, or Maple Hall)",
        bounds: [[
            [43.78581251993426, -79.18990706085283],
            [43.7859272758775, -79.18906015898503],
            [43.78452949588107, -79.18867188705174],
            [43.78447870110715, -79.18930250321202],
            [43.78581251993426, -79.18990706085283]
        ]]
    },
    {
        name: "Science Research Building (SY)",
        bounds: [[
            [43.78456297975305, -79.18975633876252],
            [43.784591412543655, -79.18933923154182],
            [43.78371184877485, -79.18919088793132],
            [43.783902832644415, -79.1897960143393],
            [43.78456297975305, -79.18975633876252]
        ]]
    },
    {
        name: "Science Wing (SW)",
        bounds: [[
            [43.783902832644415, -79.1897960143393],
            [43.78344537861094, -79.18871058050352],
            [43.783092777205624, -79.18881316422376],
            [43.78348542866466, -79.18976896923662],
            [43.783902832644415, -79.1897960143393]
        ], [
            [43.78391064946185, -79.18781371045205],
            [43.78369610835502, -79.18729098380975],
            [43.783201341366016, -79.18775696996717],
            [43.783092777205624, -79.18881316422376],
            [43.78344537861094, -79.18871058050352],
            [43.78391064946185, -79.18781371045205]
        ]]
    },
    {
        name: "Humanities Wing (HW)",
        bounds: [[
            [43.783797750407, -79.18721455223468],
            [43.7834883978003, -79.18639940060989],
            [43.78279466779542, -79.18669152147663],
            [43.782540989799216, -79.18727892525105],
            [43.7831006291418, -79.18779659159107],
            [43.783797750407, -79.18721455223468]
        ]]
    },
    {
        name: "Arts and Administration Building (AA)",
        bounds: [[
            [43.784846508636775, -79.18744053063953],
            [43.78462735675315, -79.18695181920786],
            [43.783973541704675, -79.18758103478805],
            [43.784073585515486, -79.18771133554185],
            [43.784846508636775, -79.18744053063953]
        ]]
    },
    {
        name: "Bladen Wing (BV)",
        bounds: [[
            [43.78475869373324, -79.18672662968649],
            [43.78458248056869, -79.18643158669472],
            [43.7837536908132, -79.18719869847314],
            [43.78390666922583, -79.18751251692798],
            [43.78475869373324, -79.18672662968649]
        ]]
    },
    {
        name: "Library and Academic Resource Building (AC)",
        bounds: [[
            [43.78458248056869, -79.18643158669472],
            [43.784137104323634, -79.18570202584242],
            [43.783476779521415, -79.18638867135047],
            [43.7837536908132, -79.18719869847314],
            [43.78458248056869, -79.18643158669472]
        ]]
    },
    {
        name: "Student Centre (SL)",
        bounds: [[
            [43.78542866676694, -79.18684889277498],
            [43.785229341523646, -79.1862791674239],
            [43.78462735675315, -79.18695181920786],
            [43.784846508636775, -79.18744053063953],
            [43.78542866676694, -79.18684889277498]
        ]]
    },
    {
        name: "Highland Hall (HL)",
        bounds: [[
            [43.785229341523646, -79.1862791674239],
            [43.78483216806493, -79.1853089777852],
            [43.784137104323634, -79.18570202584242],
            [43.78458248056869, -79.18643158669472],
            [43.785229341523646, -79.1862791674239],
        ]]
    },
    {
        name: "Kina Wiiya Enadong Building (KW)",
        bounds: [[
            [43.78315269004085, -79.18599346538146],
            [43.782939119116776, -79.1855464500973],
            [43.78249140871616, -79.18617753048841],
            [43.78279199204337, -79.18654566072043],
            [43.78315269004085, -79.18599346538146],
        ]]
    },
    {
        name: "Student Residence Center",
        bounds: [[
            [43.78380665550459, -79.1853414163227],
            [43.783634312419665, -79.1846735462778],
            [43.7830688686969, -79.18538969608498],
            [43.783305116382216, -79.1859583243963],
            [43.78380665550459, -79.1853414163227]
        ]]
    },
    {
        name: "South Residences",
        bounds: [[
            [43.784166745991456, -79.18411994543018],
            [43.78391679308166, -79.18348886503503],
            [43.78236488971707, -79.18294099283679],
            [43.7824051858055, -79.18501595460836],
            [43.782989743404116, -79.1844902669192],
            [43.78330298022522, -79.18492413468796],
            [43.784166745991456, -79.18411994543018]
        ]]
    },
    {
        name: "Instructional Centre (IC)",
        bounds: [[
            [43.78728540833786, -79.1898427281813],
            [43.78663835010672, -79.1886575047402],
            [43.7862780802118, -79.19019731026337],
            [43.78654591263943, -79.19060113985688],
            [43.78728540833786, -79.1898427281813]
        ]]
    },
    {
        name: "Environmental Science and Chemistry Building (EV)",
        bounds: [[
            [43.787631451251855, -79.19058472401976],
            [43.78728540833786, -79.1898427281813],
            [43.78654591263943, -79.19060113985688],
            [43.78722615420708, -79.19105421696179],
            [43.787631451251855, -79.19058472401976]
        ]]
    },
    {
        name: "Harmony Commons",
        bounds: [[
            [43.787996970700526, -79.18668574713828],
            [43.787207480932636, -79.1862820370387],
            [43.7867659969282, -79.18803620173493],
            [43.787571509150126, -79.18842780425122],
            [43.787996970700526, -79.18668574713828]
        ]]
    },
    {
        name: "Front Dropoff",
        bounds: [[
            [43.78629315396732, -79.18807235845149],
            [43.78540400196937, -79.18608528110646],
            [43.785233407341295, -79.18621059229038],
            [43.785517731450916, -79.18686221044678],
            [43.78484827525027, -79.18749592700551],
            [43.78635260260756, -79.18814038452282],
            [43.78629315396732, -79.18807235845149]
        ]]
    }
]

export function lookupBuilding(lat: number, lng: number): CampusBuilding | null {
    for (const building of BUILDINGS) {
        for (const poly of building.bounds) {
            const isInBounds = booleanPointInPolygon(point([lat, lng]), polygon([poly]));
            if (isInBounds)
                return building;
        }
    }
    return null;
}